# ğŸ§ Day 14 â€“ Package Management in Amazon Linux

> Installing, updating, securing, and troubleshooting software packages in production Linux systems.

![Amazon Linux](https://img.shields.io/badge/Amazon%20Linux-2%20%7C%202023-FF9900?logo=amazonlinux)
![Package Management](https://img.shields.io/badge/Topic-Package%20Management-blue)
![Level](https://img.shields.io/badge/Level-SysAdmin-green)

---

## ğŸ“Œ Overview

Package management is a core responsibility of a Linux System Administrator.

In **Amazon Linux**, we use:

* **RPM** â†’ Low-level package manager
* **YUM** â†’ Amazon Linux 2
* **DNF** â†’ Amazon Linux 2023

---

## ğŸ“¦ 1ï¸âƒ£ Package Management Architecture

```text
Application
   â†“
YUM / DNF  (Dependency Resolution)
   â†“
RPM        (Package Database + Installation)
   â†“
Repositories
   â†“
GPG Keys (Signature Verification)
```

---

# ğŸ“‚ 2ï¸âƒ£ RPM â€“ The Low-Level Tool

RPM works directly with `.rpm` files and maintains the local package database.

<details>
<summary>ğŸ” Common RPM Commands</summary>

### List all installed packages

```bash
rpm -qa
```

### Check if package is installed

```bash
rpm -q nginx
```

### Get package details

```bash
rpm -qi nginx
```

### Verify package integrity

```bash
rpm -V nginx
```

### Install local RPM file

```bash
sudo rpm -ivh package.rpm
```

âš ï¸ RPM does NOT resolve dependencies automatically.

</details>

---

# ğŸ“¦ 3ï¸âƒ£ YUM (Amazon Linux 2)

YUM resolves dependencies and pulls packages from repositories.

<details>
<summary>ğŸ“‹ YUM Commands</summary>

### Search for package

```bash
sudo yum search nginx
```

### Install package

```bash
sudo yum install nginx -y
```

### Remove package

```bash
sudo yum remove nginx -y
```

### Update specific package

```bash
sudo yum update nginx
```

### Update entire system

```bash
sudo yum update
```

</details>

---

# ğŸ“¦ 4ï¸âƒ£ DNF (Amazon Linux 2023)

DNF replaces YUM in Amazon Linux 2023.

Commands are nearly identical:

```bash
sudo dnf search nginx
sudo dnf install nginx
sudo dnf remove nginx
sudo dnf update
```

---

# ğŸ” 5ï¸âƒ£ Security Updates Only (Production Best Practice)

Instead of blindly updating everything:

### List security updates

```bash
sudo yum updateinfo list security
```

### Apply only security patches

```bash
sudo yum update --security
```

âœ”ï¸ Critical in production environments.

---

# ğŸ—‚ 6ï¸âƒ£ Repository Management

Repositories define where packages are downloaded from.

### List enabled repositories

```bash
sudo yum repolist
```

### List all repositories

```bash
sudo yum repolist all
```

### Repository configuration directory

```bash
/etc/yum.repos.d/
```

Each `.repo` file typically contains:

* `baseurl`
* `gpgcheck`
* `enabled`
* `name`

---

# ğŸ“œ 7ï¸âƒ£ YUM History â€“ Rollback Safety

Very important for real-world troubleshooting.

### View transaction history

```bash
sudo yum history
```

### Get transaction details

```bash
sudo yum history info 5
```

### Undo a transaction

```bash
sudo yum history undo 5
```

âœ”ï¸ Useful for recovering from broken updates.

---

# ğŸ”’ 8ï¸âƒ£ Version Locking (Prevent Unexpected Upgrades)

### Install plugin

```bash
sudo yum install yum-plugin-versionlock
```

### Lock a package

```bash
sudo yum versionlock add nginx
```

### List locks

```bash
sudo yum versionlock list
```

### Remove lock

```bash
sudo yum versionlock delete nginx
```

âœ”ï¸ Important when application compatibility matters.

---

# ğŸ§¹ 9ï¸âƒ£ Cleaning Cache

### Clear cache

```bash
sudo yum clean all
```

### Rebuild cache

```bash
sudo yum makecache
```

---

# ğŸš¨ 1ï¸âƒ£0ï¸âƒ£ Troubleshooting

### Check dependency issues

```bash
sudo yum check
```

### Complete unfinished transactions

```bash
sudo yum-complete-transaction
```

### Rebuild RPM database (if corrupted)

```bash
sudo rpm --rebuilddb
```

---

# ğŸ§ª Hands-On Lab

## ğŸ§© Exercise 1 â€“ Install & Validate

```bash
sudo yum install httpd -y
rpm -q httpd
systemctl status httpd
```

## ğŸ“œ Exercise 2 â€“ View History

```bash
sudo yum history
sudo yum history info last
```

## ğŸ” Exercise 3 â€“ Security Patch Review

```bash
sudo yum updateinfo summary
```

## ğŸ—‘ Exercise 4 â€“ Remove Package

```bash
sudo yum remove httpd -y
```

---

# ğŸ“Œ Key Concepts Learned

* âœ… RPM vs YUM vs DNF
* âœ… Repository structure
* âœ… Security-only updates
* âœ… Transaction rollback
* âœ… Version locking
* âœ… Troubleshooting dependency issues

---

# ğŸš€ Next: Day 15 â€“ Systemd Deep Dive

* `systemctl`
* Services & targets
* Boot process
* Enable vs start
* Service troubleshooting

---
