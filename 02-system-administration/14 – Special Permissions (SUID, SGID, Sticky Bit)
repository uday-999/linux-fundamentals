# ğŸ§ Day 14 â€“ Package Management in Amazon Linux

> Installing, updating, securing, and troubleshooting software packages in production Linux systems.

Package management is a core responsibility of a Linux System Administrator.  
In Amazon Linux, we use:

- **RPM** (Low-level package tool)
- **YUM** (Amazon Linux 2)
- **DNF** (Amazon Linux 2023)

---

# ğŸ“¦ 1ï¸âƒ£ Understanding the Package Management Architecture

```
Application
   â†“
YUM / DNF  (Dependency resolution)
   â†“
RPM        (Package database + installation)
   â†“
Repositories
   â†“
GPG Keys (Signature verification)
```

---

# ğŸ“‚ 2ï¸âƒ£ RPM â€“ The Low-Level Tool

RPM works directly with `.rpm` files and maintains the local package database.

## ğŸ” List all installed packages
```bash
rpm -qa
```

## ğŸ” Check if package is installed
```bash
rpm -q nginx
```

## ğŸ“‹ Get package details
```bash
rpm -qi nginx
```

## ğŸ” Verify package integrity
```bash
rpm -V nginx
```

## ğŸ“¦ Install local RPM file
```bash
sudo rpm -ivh package.rpm
```

âš ï¸ RPM does NOT resolve dependencies automatically.

---

# ğŸ“¦ 3ï¸âƒ£ YUM (Amazon Linux 2)

YUM resolves dependencies and pulls packages from repositories.

## ğŸ” Search for package
```bash
sudo yum search nginx
```

## ğŸ“¥ Install package
```bash
sudo yum install nginx -y
```

## âŒ Remove package
```bash
sudo yum remove nginx -y
```

## ğŸ”„ Update specific package
```bash
sudo yum update nginx
```

## ğŸ”„ Update entire system
```bash
sudo yum update
```

---

# ğŸ“¦ 4ï¸âƒ£ DNF (Amazon Linux 2023)

DNF replaces YUM in AL2023.

Commands are almost identical:

```bash
sudo dnf search nginx
sudo dnf install nginx
sudo dnf remove nginx
sudo dnf update
```

---

# ğŸ” 5ï¸âƒ£ Security Updates Only (Production Practice)

Instead of updating everything blindly:

## List security updates
```bash
sudo yum updateinfo list security
```

## Apply only security patches
```bash
sudo yum update --security
```

This is critical in production environments.

---

# ğŸ—‚ 6ï¸âƒ£ Repository Management

Repositories define where packages are downloaded from.

## List enabled repositories
```bash
sudo yum repolist
```

## List all repositories
```bash
sudo yum repolist all
```

## Repository configuration location
```
/etc/yum.repos.d/
```

Each `.repo` file contains:
- baseurl
- gpgcheck
- enabled
- name

---

# ğŸ“œ 7ï¸âƒ£ YUM History â€“ Rollback Safety

Very important for real-world troubleshooting.

## View transaction history
```bash
sudo yum history
```

## Get transaction details
```bash
sudo yum history info 5
```

## Undo a transaction
```bash
sudo yum history undo 5
```

This can recover from broken updates.

---

# ğŸ”’ 8ï¸âƒ£ Version Locking (Prevent Unexpected Upgrades)

Install plugin:
```bash
sudo yum install yum-plugin-versionlock
```

Lock a package:
```bash
sudo yum versionlock add nginx
```

List locks:
```bash
sudo yum versionlock list
```

Remove lock:
```bash
sudo yum versionlock delete nginx
```

Useful when application compatibility matters.

---

# ğŸ§¹ 9ï¸âƒ£ Cleaning Cache

Clear cache:
```bash
sudo yum clean all
```

Rebuild cache:
```bash
sudo yum makecache
```

---

# ğŸš¨ 1ï¸âƒ£0ï¸âƒ£ Troubleshooting

## Dependency issues
```bash
sudo yum check
```

## Complete unfinished transactions
```bash
sudo yum-complete-transaction
```

## Rebuild RPM database (if corrupted)
```bash
sudo rpm --rebuilddb
```

---

# ğŸ§ª Hands-On Lab

### Exercise 1 â€“ Install & Validate
```bash
sudo yum install httpd -y
rpm -q httpd
systemctl status httpd
```

### Exercise 2 â€“ View History
```bash
sudo yum history
sudo yum history info last
```

### Exercise 3 â€“ Security Patch Review
```bash
sudo yum updateinfo summary
```

### Exercise 4 â€“ Remove Package
```bash
sudo yum remove httpd -y
```

---

# ğŸ“Œ Key Concepts Learned

âœ… RPM vs YUM vs DNF  
âœ… Repository structure  
âœ… Security-only updates  
âœ… Transaction rollback  
âœ… Version locking  
âœ… Troubleshooting dependency issues  

---

# ğŸš€ Next: Day 15

Systemd Deep Dive  
- systemctl
- Services & targets
- Boot process
- Enable vs start
- Service troubleshooting

---
